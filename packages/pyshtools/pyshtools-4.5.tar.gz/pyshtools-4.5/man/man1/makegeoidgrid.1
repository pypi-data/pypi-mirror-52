.\" Automatically generated by Pandoc 2.7.3
.\"
.TH "makegeoidgrid" "1" "2019-09-17" "Fortran 95" "SHTOOLS 4.5"
.hy
.SH MakeGeoidGrid
.PP
Create a global map of the geoid.
.SH Usage
.PP
call MakeGeoidGrid (\f[C]geoid\f[R], \f[C]cilm\f[R], \f[C]lmax\f[R],
\f[C]r0\f[R], \f[C]gm\f[R], \f[C]potref\f[R], \f[C]omega\f[R],
\f[C]r\f[R], \f[C]gridtype\f[R], \f[C]order\f[R], \f[C]nlat\f[R],
\f[C]nlong\f[R], \f[C]interval\f[R], \f[C]lmax_calc\f[R], \f[C]a\f[R],
\f[C]f\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
.B \f[C]geoid\f[R] : output, real(dp), dimension(\f[C]nlat\f[R], \f[C]nlong\f[R])
A global grid of the height to the potential \f[C]potref\f[R] above a
sphere of radius \f[C]r\f[R] (or above a flattened ellipsoid if both
\f[C]a\f[R] and \f[C]f\f[R] are specified).
The number of latitude and longitude points depends upon
\f[C]gridtype\f[R]: (1) \f[C]lmax+1\f[R] by \f[C]2lmax+1\f[R], (2)
\f[C]2lmax+2\f[R] by \f[C]2lmax+2\f[R], (3) \f[C]2lmax+2\f[R] by
\f[C]4lmax+4\f[R], or (4) \f[C]180/interval+1\f[R] by
\f[C]360/interval+1\f[R].
.TP
.B \f[C]cilm\f[R] : input, real(dp), dimension (2, \f[C]lmax\f[R]+1, \f[C]lmax\f[R]+1)
The real spherical harmonic coefficients (geodesy normalized) of the
gravitational potential referenced to a spherical interface of radius
\f[C]r0pot\f[R].
.TP
.B \f[C]lmax\f[R] : input, integer
The maximum spherical harmonic degree of the gravitational-potential
coefficients.
For \f[C]gridtype\f[R]s 1, 2 and 3, this determines the number of
latitudinal and longitudinal samples.
.TP
.B \f[C]r0\f[R] : input, real(dp)
The reference radius of the spherical harmonic coefficients.
.TP
.B \f[C]gm\f[R] : input, real(dp)
The product of the gravitational constant and mass of the planet.
.TP
.B \f[C]potref\f[R] : input, real(dp)
The value of the potential on the chosen geoid, in SI units.
.TP
.B \f[C]omega\f[R] : input, real(dp)
The angular rotation rate of the planet.
.TP
.B \f[C]r\f[R] : input, real(dp)
The radius of the reference sphere that the Taylor expansion of the
potential is performed on.
If \f[C]a\f[R] and \f[C]f\f[R] are not specified, the geoid height will
be referenced to this spherical interface.
.TP
.B \f[C]gridtype\f[R] : input, integer
The output grid is (1) a Gauss-Legendre quadrature grid whose grid nodes
are determined by \f[C]lmax\f[R], (2) an equally sampled \f[C]n\f[R] by
\f[C]n\f[R] grid used with the Driscoll and Healy (1994) sampling
theorem, (3) ar a similar \f[C]n\f[R] by 2\f[C]n\f[R] grid that is
oversampled in longitude, or (4) a 2D Cartesian grid with latitudinal
and longitudinal spacing given by \f[C]interval\f[R].
.TP
.B \f[C]order\f[R] : input, integer
The order of the Taylor series expansion of the potential about the
reference radius \f[C]r\f[R].
This can be either 1, 2, or 3.
.TP
.B \f[C]nlat\f[R] : output, integer
The number of latitudinal samples.
.TP
.B \f[C]nlong\f[R] : output, integer
The number of longitudinal samples.
.TP
.B \f[C]interval\f[R]: optional, input, real(dp)
The latitudinal and longitudinal spacing of the output grid when
\f[C]gridtype\f[R] is 4.
.TP
.B \f[C]lmax_calc\f[R] : optional, input, integer
The maximum degree used in evaluating the spherical harmonic
coefficients.
This must be less than or equal to \f[C]lmax\f[R].
.TP
.B \f[C]a\f[R] : optional, input, real(dp), default = \f[C]r0\f[R]
The semi-major axis of the flattened ellipsoid that the output grid
\f[C]geoid\f[R] is referenced to.
The optional parameter \f[C]f\f[R] must also be specified.
.TP
.B \f[C]f\f[R] : optional, input, real(dp), default = 0
The flattening \f[C](R_equator-R_pole)/R_equator\f[R] of the reference
ellipsoid.
The optional parameter \f[C]a\f[R] (i.e., \f[C]R_equator\f[R]) must be
specified.
.TP
.B \f[C]exitstatus\f[R] : output, optional, integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]MakeGeoidGrid\f[R] will create a global map of the geoid, accurate
to either first, second, or third order, using the method described in
Wieczorek (2007; equation 19-20).
The algorithm expands the potential in a Taylor series on a spherical
interface of radius \f[C]r\f[R], and computes the height above this
interface to the potential \f[C]potref\f[R] exactly from the linear,
quadratic, or cubic equation at each grid point.
If the optional parameters \f[C]a\f[R] and \f[C]f\f[R] are specified,
the geoid height will be referenced to a flattened ellipsoid with
semi-major axis \f[C]a\f[R] and flattening \f[C]f\f[R].
The pseudo-rotational potential is explicitly accounted for by
specifying the angular rotation rate \f[C]omega\f[R] of the planet.
.PP
It should be noted that this geoid calculation is only strictly exact
when the radius \f[C]r\f[R] lies above the maximum radius of the planet.
Furthermore, the geoid is only strictly valid when it lies above the
surface of the planet (it is necessary to know the density structure of
the planet when calculating the potential below the surface).
.PP
The geoid can be computed on one of four different grids: (1) a
Gauss-Legendre quadrature grid (see \f[C]MakeGridGLQ\f[R]), (2) A
\f[C]n\f[R] by \f[C]n\f[R] equally sampled grid (see
\f[C]MakeGridDH\f[R]), (3) an \f[C]n\f[R] by 2\f[C]n\f[R] equally spaced
grid (see \f[C]MakeGridDH\f[R]), or (4) A 2D Cartesian grid (see
\f[C]MakeGrid2D\f[R]).
This routine uses geodesy 4-pi normalized spherical harmonics that
exclude the Condon-Shortley phase.
This can not be modified.
.SH References
.PP
Driscoll, J.R.
and D.M.
Healy, Computing Fourier transforms and convolutions on the 2-sphere,
Adv.
Appl.
Math., 15, 202-250, 1994.
.PP
Wieczorek, M.
A.
Gravity and topography of the terrestrial planets, Treatise on
Geophysics, 10, 165-206, 2007.
.SH See also
.PP
makegrid2d, makegridglq, makegriddh, makegravgriddh, makegravgradgriddh
