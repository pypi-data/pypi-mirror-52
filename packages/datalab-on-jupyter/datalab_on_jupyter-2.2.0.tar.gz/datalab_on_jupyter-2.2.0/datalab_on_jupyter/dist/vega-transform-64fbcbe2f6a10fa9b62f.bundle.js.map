{"version":3,"sources":["webpack:////Users/felix/Dropbox/KoppeDesign/Projekte/cavorit/datalab/packages/transform-vega/src/mime.ts","webpack:////Users/felix/Dropbox/KoppeDesign/Projekte/cavorit/datalab/packages/transform-vega/src/external.ts","webpack:////Users/felix/Dropbox/KoppeDesign/Projekte/cavorit/datalab/packages/transform-vega/src/react.tsx","webpack:////Users/felix/Dropbox/KoppeDesign/Projekte/cavorit/datalab/packages/transform-vega/src/index.tsx"],"names":["MEDIA_TYPES","application/vnd.vega.v2+json","kind","version","vegaLevel","mediaType","schemaPrefix","application/vnd.vega.v3+json","application/vnd.vega.v4+json","application/vnd.vega.v5+json","application/vnd.vegalite.v1+json","application/vnd.vegalite.v2+json","application/vnd.vegalite.v3+json","deepThaw","spec","JSON","parse","stringify","react_VegaEmbed","react","[object Object]","props","super","this","anchorRef","ref","current","result","anchor","options","defaults","actions","mode","Promise","all","__webpack_require__","e","then","bind","default","vegaEmbed","Object","util","assign","external_embed","resultHandler","error","errorHandler","console","nextProps","callEmbedder","d","__webpack_exports__","Vega","Vega2","Vega3","Vega4","Vega5","VegaLite1","VegaLite2","VegaLite3","embed","data","onResult","onError","MIMETYPE"],"mappings":"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","file":"vega-transform-64fbcbe2f6a10fa9b62f.bundle.js","sourcesContent":["/** Single MIME string. */\nexport type VegaMediaType =\n  | \"application/vnd.vega.v2+json\"\n  | \"application/vnd.vega.v3+json\"\n  | \"application/vnd.vega.v4+json\"\n  | \"application/vnd.vega.v5+json\"\n  | \"application/vnd.vegalite.v1+json\"\n  | \"application/vnd.vegalite.v2+json\"\n  | \"application/vnd.vegalite.v3+json\";\n\n/** Information about a particular Vega or Vega Lite version. */\nexport interface VegaMediaTypeInfo<T extends VegaMediaType> {\n  kind: \"vega\" | \"vega-lite\",\n  version: string,\n  vegaLevel: 2 | 3 | 4 | 5,\n  mediaType: T,\n  schemaPrefix: string,\n}\n\n/** Information about all known Vega or Vega Lite versions. */\nexport type VegaMediaTypes = { [K in VegaMediaType]: VegaMediaTypeInfo<K> }\n\n/** All the information. All of it. On Vega (Lite) media types, at least. */\nexport const MEDIA_TYPES: VegaMediaTypes = {\n  \"application/vnd.vega.v2+json\": {\n    kind: \"vega\",\n    version: \"2\",\n    vegaLevel: 2,\n    mediaType: \"application/vnd.vega.v2+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega/v2\",\n  },\n  \"application/vnd.vega.v3+json\": {\n    kind: \"vega\",\n    version: \"3\",\n    vegaLevel: 3,\n    mediaType: \"application/vnd.vega.v3+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega/v3\",\n  },\n  \"application/vnd.vega.v4+json\": {\n    kind: \"vega\",\n    version: \"4\",\n    vegaLevel: 4,\n    mediaType: \"application/vnd.vega.v4+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega/v4\",\n  },\n  \"application/vnd.vega.v5+json\": {\n    kind: \"vega\",\n    version: \"5\",\n    vegaLevel: 5,\n    mediaType: \"application/vnd.vega.v5+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega/v5\",\n  },\n  \"application/vnd.vegalite.v1+json\": {\n    kind: \"vega-lite\",\n    version: \"1\",\n    vegaLevel: 2,\n    mediaType: \"application/vnd.vegalite.v1+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega-lite/v1\",\n  },\n  \"application/vnd.vegalite.v2+json\": {\n    kind: \"vega-lite\",\n    version: \"2\",\n    vegaLevel: 3,\n    mediaType: \"application/vnd.vegalite.v2+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega-lite/v2\",\n  },\n  \"application/vnd.vegalite.v3+json\": {\n    kind: \"vega-lite\",\n    version: \"3\",\n    vegaLevel: 5,\n    mediaType: \"application/vnd.vegalite.v3+json\",\n    schemaPrefix: \"https://vega.github.io/schema/vega-lite/v3\",\n  },\n};\n","import { promisify } from \"util\";\nimport { MEDIA_TYPES, VegaMediaType } from \"./mime\";\n\nexport interface VegaOptions {\n  renderer: \"canvas\" | \"svg\";\n}\n\n/** Call the external library to do the embedding. */\nexport async function embed(\n  anchor: HTMLElement,\n  mediaType: VegaMediaType,\n  spec: Readonly<{}>,\n  options: Partial<VegaOptions> = {},\n): Promise<any> {\n  const version = MEDIA_TYPES[mediaType];\n  const defaults = {\n    actions: false,\n    mode: version.kind,\n  };\n\n  switch (version.vegaLevel) {\n    case 2:\n      return await import(\"@nteract/vega-embed-v2\").then(\n        ({ default: vegaEmbed }) =>\n          promisify(vegaEmbed)(anchor, {...defaults, ...options, spec})\n      );\n\n    case 3:\n      return await import(\"@nteract/vega-embed-v3\").then(\n        ({ default: vegaEmbed }) =>\n          vegaEmbed(anchor, deepThaw(spec), {...defaults, ...options})\n      );\n\n    case 4:\n    case 5:\n      return await import(\"vega-embed\").then(\n        ({ default: vegaEmbed }) =>\n          vegaEmbed(anchor, deepThaw(spec), {...defaults, ...options})\n      );\n  }\n}\n\nfunction deepThaw(spec: Readonly<{}>): {} {\n  return JSON.parse(JSON.stringify(spec));\n}\n","import * as React from \"react\";\nimport { embed, VegaOptions } from \"./external\";\nimport { VegaMediaType } from \"./mime\";\n\n/** Props needed for embedding a certain Vega (Lite) media type. */\nexport interface VegaEmbedProps<T extends VegaMediaType> {\n  spec: Readonly<{}>;\n  mediaType: T;\n  options?: Partial<VegaOptions>,\n  resultHandler?: (result: any) => void;\n  errorHandler?: (error: Error) => void;\n}\n\n/** React component embedding a certain Vega (Lite) media type. */\nexport class VegaEmbed<T extends VegaMediaType>\n  extends React.Component<VegaEmbedProps<T>> {\n\n  private anchorRef: React.RefObject<HTMLDivElement>;\n\n  constructor(props: VegaEmbedProps<T>) {\n    super(props);\n    this.anchorRef = React.createRef<HTMLDivElement>();\n  }\n\n  render(): JSX.Element {\n    return <div ref={this.anchorRef} />;\n  }\n\n  async callEmbedder(): Promise<void> {\n    if (this.anchorRef.current === null) { return; }\n\n    try {\n      const result = await embed(\n        this.anchorRef.current,\n        this.props.mediaType,\n        this.props.spec,\n        this.props.options,\n      );\n\n      if (this.props.resultHandler) {\n        this.props.resultHandler(result);\n      }\n    }\n    catch (error) {\n      (this.props.errorHandler || console.error)(error);\n    }\n  }\n\n  shouldComponentUpdate(nextProps: VegaEmbedProps<T>): boolean {\n    return this.props.spec !== nextProps.spec;\n  }\n\n  componentDidMount(): void {\n    this.callEmbedder().then();\n  }\n\n  componentDidUpdate(): void {\n    this.callEmbedder().then();\n  }\n}\n","import * as React from \"react\";\nimport { VegaOptions } from \"./external\";\nimport { VegaMediaType } from \"./mime\";\nimport { VegaEmbed } from \"./react\";\n\nexport { VegaOptions, VegaMediaType };\n\nexport interface VegaProps  {\n  data: Readonly<{}>;\n  options?: Partial<VegaOptions>;\n  onResult?: (result: any) => void;\n  onError?: (error: Error) => void;\n}\n\nexport const Vega = (mediaType: VegaMediaType) => {\n  const embed = ({data, options, onResult, onError}: VegaProps)  =>\n    <VegaEmbed\n      mediaType={mediaType}\n      spec={data}\n      options={options}\n      resultHandler={onResult}\n      errorHandler={onError}\n    />;\n\n  embed.MIMETYPE = mediaType;\n  return embed;\n};\n\nexport const Vega2 = Vega(\"application/vnd.vega.v2+json\");\nexport const Vega3 = Vega(\"application/vnd.vega.v3+json\");\nexport const Vega4 = Vega(\"application/vnd.vega.v4+json\");\nexport const Vega5 = Vega(\"application/vnd.vega.v5+json\");\nexport const VegaLite1 = Vega(\"application/vnd.vegalite.v1+json\");\nexport const VegaLite2 = Vega(\"application/vnd.vegalite.v2+json\");\nexport const VegaLite3 = Vega(\"application/vnd.vegalite.v3+json\");\n"],"sourceRoot":""}