{% load base_taglib %}

<div class="header-container">
    <div class="header-logo">
        <picture>
            <source srcset="{% static_content_url %}/images/psu_knot.png" media="(max-width: 768px)">
            {% image src="psu_logo.png" alt="PSU Logo" style="height: 30px;" %}
        </picture>
    </div>
    <div class="header-title">
        {% app_name %}
    </div>

    <!-- <div class="header-right float-right"> -->
    <div class="header-right">
        <div class="header-menu" id="sso-menu">
            {%sso_menu%}
        </div>
        <div class="header-menu" id="dev-menu">
            {%developer_menu%}
        </div>
    </div>

    <div class="menu-responsive">
        <a href="javascript:void(0);" class="icon nav-icon"">
            <i style="line-height:40px;font-size:1.2em;" class="fa fa-bars"></i>
        </a>
    </div>
</div>
<!-- <div style="height: 50px;">&nbsp;</div> -->

<style>
    /** Header styles (needs refactoring) **/
    * {box-sizing: border-box;}

    .header-container{
        /* position: fixed; */
        top: 0;
        left:0;
        right: 0;
        display: grid;
        grid-template-columns: minmax(160px, 0.3fr) 1fr 1fr;
        grid-template-areas: "logo title menu1";
        background-color: #6A7F10;
        color: whitesmoke;
        align-items: center;
        grid-gap: 10px;
        padding: 3px 5px;
        font-size: 1.1em;
        line-height: 40px;
    }
    .header-logo {
        padding: 0 12px;
    }
    .header-logo img{
        max-width:100%;
        height:auto;
    }
    .header-title{
        justify-self: start;
        font-weight: bold;
        /* padding: 0px 15px; */
        margin: auto;
        text-align: center;
    }

    .header-container a{
        color: whitesmoke;
        text-decoration: underline;
        cursor: pointer;
        white-space: nowrap;
    }

    .header-right {
        float: right;
        /* right: 0px; */
        padding-right: 12px;
        background-color: #6A7F10;
    }

    .header-menu {
        float: right;
        line-height: 20px;
        display: block !important;
    }

    .header-right {
        grid-area: menu1;
        /* margin: auto; */
        float: right;

    }
    /* #dev-menu {
        grid-area: menu1
    } */

    /* #sso-menu {
        grid-area: menu2
    } */

    .menuname {
        display: inline-block;
    }

    .menu-top {
        padding: 4px 12px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .dropdown-user {
        display: none;
        /* padding: 10px; */
    }

    .dev-icon {
        display: none;
    }
    .header-right a.icon {
        /* float: right; */
        display: none;
    }
    .menu-responsive {
        display: none;
    }

    .dropbtn {
        background-color: rgba(0,0,0,0.0);
        color: white;
        padding: 4px 12px;
        font-size: 16px;
        border: none;
        height: 47px;
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #6A7F10;
        min-width: 200px;
        z-index: 1;
        font-size: 14px;
        right: 0px;
    }

    .dropdown-content a, .dropdown-content b {
        color: white;
        padding: 8px 12px;
        text-decoration: none;
        display: block;
    }

    .dropdown-content a:hover {background-color: rgb(85, 100, 18);}
    /* .dropdown:hover .dropdown-content {display: block;} */
    .dropdown:hover .dropbtn {background-color: rgb(85, 100, 18);}

    @media screen and (max-width: 956px) {
    }
    @media screen and (max-width: 860px) {
        .menuname {
            display: none;
        }
        .dev-icon {
            display: inline-block;
        }
        .dropdown-user{
            display: block;
        }
    }

    /* @media screen and (min-width: 769px) {
        .header-menu {
            display: inline-block;
        }
    } */

    @media screen and (max-width: 768px) {
        .header-container{
            padding: 3px 5px;
            grid-row-gap: 3px;
            /* grid-gap: 5px; */
            /* grid-template-rows: 50px 1fr; */
            grid-template-columns: minmax(60px, 0.1fr) minmax(120px, 1fr) 60px;
            grid-template-areas:
                "logo title menu1"
                "menu2 menu2 menu2";
            /* position: relative; */

        }
        /* .menuname {
            display: none;
        } */

        .header-menu {
            display: block;
            float: left;
            text-align: left;
        }

        .dropbtn {
            display: none;
        }
        .dropdown-content {
            display: none;
            position: relative;
            left: 0;
            text-align: left;
            margin: auto;
            max-width: 100%;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        .dropdown-content a {
            display: block !important;
        }
        .header-right {
            grid-area: menu2;
            grid-column: 1 / -1;
            margin: auto;
            float: none;
            display: none;
        }
        /* .header-right div {display: none;} */
        .menu-responsive a.icon {
            float: right;
            display: block;
            padding: 0px 12px;
        }
        .menu-responsive {
            display: block;
            grid-area: menu1;
        }
    }
    /* @media screen and (max-width: 568px) {
        .header-container{
            grid-gap: 3px;
        }

    } */

    /* @media screen and (max-width: 600px) {
        .header-right div {display: none;}
        .header-right a.icon {
            float: right;
            display: block;
        }
    } */
</style>
    <script>
        // Show dropdown on click
        $('.dropbtn').click(function(e) {
            e.stopPropagation();  // prevents dropdown closed

            var thisId = $(this).parents('.header-menu').attr('id');

            // Find the other dropdowns
            var otherDropdowns = $(this).parents('.header-right').find('.header-menu');

            // Close any other open dropdowns
            otherDropdowns.toArray().forEach(function (e) {
                console.log(e)
                if (e.id != thisId) {
                    console.log(e.id);
                    $('#'+e.id).find('.dropdown-content').hide();
                }
            })
            $(this).siblings('.dropdown-content').toggle('medium');
            // console.log('click!');
        })

        // Clicking an item in an open dropdown should not close the dropdown
        $('.dropdown-content a').click(function(e) {
            e.stopPropagation();
        })
        $(document).click( function(event) {
            // Hides dropdown by clicking anywhere outside the dropdown
            console.log('arg!');
            $('.dropdown-content:visible').toggle('slow');
            resetDisplay();
        });

        $(window).on('resize', function(){
            // $('.header-right').css('display', '');
            // $('.dropdown-content').css('display', '');
            resetDisplay();
        });

        $('.nav-icon').click(function(e) {
            e.stopPropagation();

            $('.header-right').toggle('medium');
            $('.dropdown-content').delay(240).toggle('slow');
            console.log('expandMenu! ' + $('.header-right').attr('class'));
        });

        var resetDisplay = function() {
            $('.header-right').css('display', '');
            $('.dropdown-content').css('display', '');
        }

    </script>