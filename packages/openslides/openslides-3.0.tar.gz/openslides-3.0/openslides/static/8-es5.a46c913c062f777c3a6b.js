function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"30jZ":function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n("4X/P");function a(t){switch(t.type){case i.b.TYPE_REPLACEMENT:return"Replacement";case i.b.TYPE_INSERTION:return"Insertion";case i.b.TYPE_DELETION:return"Deletion";default:return t.other_description}}},y50V:function(t,e,n){"use strict";var i,a,r,o=n("BBYV"),s=n("dOok"),l=n("8Y7J"),c=n("TSSN"),u=((i=function(){function t(t,e,n){this.motionRepo=t,this.translate=e,this.htmlToPdfService=n}var e=t.prototype;return e.renderDiffLines=function(t){if(t.diffLines&&t.diffLines.length){var e=t.diffLines.map(function(t){return t.text}).join("<br />[...]<br />");return this.htmlToPdfService.convertHtml(e)}},e.amendmentToTableRow=function(t){var e="";return t.recommendation&&(e+=t.recommendation.show_recommendation_extension_field&&t.recommendationExtension?" "+this.motionRepo.getExtendedRecommendationLabel(t):this.translate.instant(t.recommendation.recommendation_label)),[{text:t.identifierOrTitle},{text:t.getChangeLines()},{text:t.submittersAsUsers.toString()},{text:this.renderDiffLines(t)},{text:e}]},e.overviewToDocDef=function(t,e){var n={text:t,style:"title"},i=[[{text:this.translate.instant("Motion"),style:"tableHeader"},{text:this.translate.instant("Line"),style:"tableHeader"},{text:this.translate.instant("Submitters"),style:"tableHeader"},{text:this.translate.instant("Changes"),style:"tableHeader"},{text:this.translate.instant("Recommendation"),style:"tableHeader"}]],a=[],r=e,o=Array.isArray(r),s=0;for(r=o?r:r[Symbol.iterator]();;){var l;if(o){if(s>=r.length)break;l=r[s++]}else{if((s=r.next()).done)break;l=s.value}var c=l;a.push(this.amendmentToTableRow(c))}return[n,{table:{widths:["auto","auto","auto","*","auto"],headerRows:1,dontBreakRows:!0,body:i.concat(a)},layout:"switchColorTableLayout"}]},t}()).ngInjectableDef=l.Xb({factory:function(){return new i(l.Yb(s.a),l.Yb(c.k),l.Yb(o.a))},token:i,providedIn:"root"}),i),h=n("a9GI"),d=n("+KbT"),f=n("iTQr"),m=n("pSLD"),p=n("+B0n"),v=n("Mluu"),g=n("a9XT"),b=n("GEzB"),T=n("30jZ"),S=n("ykax"),x=n("jcOe"),y=((r=function(){function t(t,e,n,i,a,r,o,s,l,c){this.translate=t,this.motionRepo=e,this.statuteRepo=n,this.changeRecoRepo=i,this.configService=a,this.pdfDocumentService=r,this.htmlToPdfService=o,this.pollService=s,this.linenumberingService=l,this.commentRepo=c,this.getRecommendationTypeName=T.a}var e=t.prototype;return e.motionToDocDef=function(t,e){var n=e&&e.lnMode?e.lnMode:null,i=e&&e.crMode?e.crMode:null,a=e?e.metaInfo:null,r=e?e.content:null,o=e?e.comments:null,s=this.configService.instant("motions_line_length"),l=this.configService.instant("motions_export_follow_recommendation"),c=[];t.isStatuteAmendment()&&(n=x.b.None,i=x.a.Diff),n||(n=this.configService.instant("motions_default_line_numbering")),i||(i=this.configService.instant("motions_recommendation_text_mode"));var u=this.createTitle(t,i,s),h=!a||a.includes("id");if(c=[u,this.createSubtitle(t,h)],a&&a.length>0||!a){var d=this.createMetaInfoTable(t,s,i,a,l);c.push(d)}if(!r||r.includes("text")){var f=this.createPreamble(t);c.push(f);var m=this.createText(t,s,n,i);c.push(m)}if(!r||r.includes("reason")){var p=this.createReason(t,n);c.push(p)}return a&&a.includes("allcomments")&&(o=this.commentRepo.getViewModelList().map(function(t){return t.id})),o&&c.push(this.createComments(t,o)),c},e.createTitle=function(t,e,n){var i=this.getUnifiedChanges(t,n).find(function(t){return t.isTitleChange()}),a=this.changeRecoRepo.getTitleWithChanges(t.title,i,e),r=t.identifier?" "+t.identifier:"",o="";return"A4"===this.configService.instant("general_export_pdf_pagesize")&&(o+=this.translate.instant("Motion")+" "),{text:o+=r+": "+a,style:"title"}},e.createSubtitle=function(t,e){var n=[];return e&&n.push(this.translate.instant("Sequential number")+": "+t.id),t.parent_id&&(e&&n.push(" \u2022 "),n.push(this.translate.instant("Amendment to")+" "+(t.parent.identifier||t.parent.title))),{text:n,style:"subtitle"}},e.createMetaInfoTable=function(t,e,n,i,a){var r,o,s=this,l=[];if(!i||i.includes("submitters")){var c=t.submittersAsUsers.map(function(t){return t.full_name}).join(", ");l.push([{text:this.translate.instant("Submitters")+":",style:"boldText"},{text:c}])}if(this.configService.instant("motions_min_supporters")&&t.supporters.length>0){var u=t.supporters.map(function(t){return t.full_name}).join(", ");l.push([{text:this.translate.instant("Supporters")+":",style:"boldText"},{text:u}])}(i&&!i.includes("state")||l.push([{text:this.translate.instant("State")+":",style:"boldText"},{text:this.motionRepo.getExtendedStateLabel(t)}]),!t.recommendation||i&&!i.includes("recommendation")||(r=t.isStatuteAmendment()?this.configService.instant("motions_statute_recommendations_by"):this.configService.instant("motions_recommendations_by"),l.push([{text:r+":",style:"boldText"},{text:this.motionRepo.getExtendedRecommendationLabel(t)}])),!t.category||i&&!i.includes("category"))||(o=t.category.parent?t.category.parent.toString()+"\n"+this.translate.instant("Subcategory")+": "+t.category.toString():t.category.toString(),l.push([{text:this.translate.instant("Category")+":",style:"boldText"},{text:o}]));if(t.tags.length&&(!i||i.includes("tags"))){var h=t.tags.map(function(t){return t}).join(", ");l.push([{text:this.translate.instant("Tags")+":",style:"boldText"},{text:h}])}if(!t.motion_block||i&&!i.includes("motion_block")||l.push([{text:this.translate.instant("Motion block")+":",style:"boldText"},{text:t.motion_block.title}]),!t.origin||i&&!i.includes("origin")||l.push([{text:this.translate.instant("Origin")+":",style:"boldText"},{text:t.origin}]),t.motion.polls.length&&(!i||i.includes("polls"))){var d=[],f=[],m=[];t.motion.polls.map(function(e,n){if(e.has_votes){t.motion.polls.length>1&&(d.push(n+1+". "+s.translate.instant("Vote")),f.push(""),m.push(""));var i=["yes","no","abstain"];e.votesvalid&&i.push("votesvalid"),e.votesinvalid&&i.push("votesinvalid"),e.votescast&&i.push("votescast"),i.map(function(t){d.push(s.translate.instant(s.pollService.getLabel(t))+":"),f.push(""+s.translate.instant(s.pollService.getSpecialLabel(e[t]))),s.pollService.isAbstractValue(e,t)?m.push(""):m.push("("+s.pollService.calculatePercentage(e,t)+" %)")})}}),l.push([{text:this.translate.instant("Voting result")+":",style:"boldText"},{columns:[{text:d.join("\n"),width:"auto"},{text:f.join("\n"),width:"auto",alignment:"right"},{text:m.join("\n"),width:"auto",alignment:"right"}],columnGap:7}])}var p=this.getUnifiedChanges(t,e);if(n===x.a.Diff&&p.length>0){var v=[],g=[];p.forEach(function(t){if(t.isTitleChange()){var e=t;v.push(s.translate.instant("Title")+": "),g.push("("+s.translate.instant("Change recommendation")+") - "+s.translate.instant(s.getRecommendationTypeName(e)))}else{var n;if(n=t.getLineFrom()>=t.getLineTo()-1?t.getLineFrom():t.getLineFrom()+" - "+(t.getLineTo()-1),t.getChangeType()===b.a.TYPE_CHANGE_RECOMMENDATION){var i=t;v.push(s.translate.instant("Line")+" "+n+": "),g.push("("+s.translate.instant("Change recommendation")+") - "+s.translate.instant(s.getRecommendationTypeName(i)))}else if(t.getChangeType()===b.a.TYPE_AMENDMENT){var a=t,r="("+s.translate.instant("Amendment")+" "+a.getIdentifier()+") -";a.isRejected()?r+=" "+s.translate.instant("Rejected"):a.isAccepted()&&(r+=" "+s.translate.instant(a.stateName),v.push(s.translate.instant("Line")+" "+n+": "),g.push(r))}}}),g.length>0&&l.push([{text:this.translate.instant("Summary of changes:"),style:"boldText"},{columns:[{text:v.join("\n"),width:"auto"},{text:g.join("\n"),width:"auto"}],columnGap:7}])}if(a&&l.push([{text:this.translate.instant("Decision")+":",style:"boldText"},{margin:[5,2,0,2],columns:[{width:8,canvas:this.pdfDocumentService.drawCircle(6.5,4)},{width:"auto",text:this.translate.instant("As recommendation")},{width:20,text:""},{width:8,canvas:this.pdfDocumentService.drawCircle(6.5,4)},{width:"auto",text:this.translate.instant("Divergent:")}]}]),l.length>0)return{table:{widths:["35%","65%"],body:l},margin:[0,0,0,20],layout:"metaboxLayout"}},e.createPreamble=function(t){var e=this.configService.instant("motions_preamble");return{text:""+this.translate.instant(e),margin:[0,10,0,10]}},e.createText=function(t,e,n,i){var a="";if(t.isParagraphBasedAmendment()){var r=this.motionRepo.getAmendmentParagraphs(t,e,!1),o=Array.isArray(r),s=0;for(r=o?r:r[Symbol.iterator]();;){var l;if(o){if(s>=r.length)break;l=r[s++]}else{if((s=r.next()).done)break;l=s.value}var c=l;a+=c.diffLineTo===c.diffLineFrom+1?"<h3>\n                        "+this.translate.instant("Line")+" "+c.diffLineFrom+":\n                    </h3>":"<h3>\n                        "+this.translate.instant("Line")+" "+c.diffLineFrom+" - "+(c.diffLineTo-1)+":\n                    </h3>",a+='<div class="paragraphcontext">'+c.textPre+"</div>",a+=c.text,a+='<div class="paragraphcontext">'+c.textPost+"</div>"}}else if(t.isStatuteAmendment()){var u=this.statuteRepo.getViewModelList();a=this.motionRepo.formatStatuteAmendment(u,t,e)}else{var h=this.getUnifiedChanges(t,e),d=h.filter(function(t){return!t.isTitleChange()}),f=h.find(function(t){return t.isTitleChange()});if(i===x.a.Diff&&f){var m=this.changeRecoRepo.getTitleChangesAsDiff(t.title,f);a+="<span><strong>"+this.translate.instant("Changed title")+":</strong><br>"+m+"</span><br>"}var p=this.motionRepo.formatMotion(t.id,i,d,e);a+=this.linenumberingService.splitInlineElementsAtLineBreaks(p)}return this.htmlToPdfService.convertHtml(a,n)},e.getUnifiedChanges=function(t,e){var n=this;return this.changeRecoRepo.getChangeRecoOfMotion(t.id).concat(this.motionRepo.getAmendmentsInstantly(t.id).flatMap(function(t){return n.motionRepo.getAmendmentAmendedParagraphs(t,e)})).sort(function(t,e){return t.getLineFrom()-e.getLineFrom()})},e.createReason=function(t,e){if(t.reason){var n=[];return n.push({text:this.translate.instant("Reason"),style:"heading3",margin:[0,25,0,10]}),n.push(this.htmlToPdfService.addPlainText(t.reason)),n}return{}},e.callListToDoc=function(t){var e=this;t.sort(function(t,e){return t.weight-e.weight});var n={text:this.translate.instant("Call list"),style:"title"},i=[[{text:this.translate.instant("Called"),style:"tableHeader"},{text:this.translate.instant("Called with"),style:"tableHeader"},{text:this.translate.instant("Submitters"),style:"tableHeader"},{text:this.translate.instant("Title"),style:"tableHeader"},{text:this.translate.instant("Recommendation"),style:"tableHeader"},{text:this.translate.instant("Notes"),style:"tableHeader"}]],a=[],r="";return t.forEach(function(t){if(!t.sort_parent_id){var n=t.tags?t.tags.map(function(t){return t.name}).join(", "):"";n!==r&&(a.push([{text:n,colSpan:6,style:"heading3",margin:[0,10,0,10]},"","","","",""]),r=n)}a.push(e.createCallListRow(t))}),[n,{table:{widths:["auto","auto","auto","*","auto","auto"],headerRows:1,dontBreakRows:!0,body:i.concat(a)},layout:"switchColorTableLayout"}]},e.createCallListRow=function(t){return[{text:t.sort_parent_id?"":t.identifierOrTitle},{text:t.sort_parent_id?t.identifierOrTitle:""},{text:t.submitters.length?t.submittersAsUsers.map(function(t){return t.short_name}).join(", "):""},{text:t.title},{text:t.recommendation?this.motionRepo.getExtendedRecommendationLabel(t):""},{text:""}]},e.textToDocDef=function(t,e,n){var i=this.configService.instant("motions_line_length"),a=this.configService.instant("motions_recommendation_text_mode"),r=this.createTitle(e,a,i),o=this.createSubtitle(e),s=this.createMetaInfoTable(e,i,a,["submitters","state","category"]),l=this.htmlToPdfService.convertHtml(t,x.b.None);return[r,o,s,{text:this.translate.instant(n),style:"heading2"},l]},e.createComments=function(t,e){var n=[],i=e,a=Array.isArray(i),r=0;for(i=a?i:i[Symbol.iterator]();;){var o;if(a){if(r>=i.length)break;o=i[r++]}else{if((r=i.next()).done)break;o=r.value}var s=o,l=this.commentRepo.getViewModel(s),c=t.getCommentForSection(l);c&&c.comment&&(n.push({text:l.name,style:"heading3",margin:[0,25,0,10]}),n.push(this.htmlToPdfService.addPlainText(c.comment)))}return n},t}()).ngInjectableDef=l.Xb({factory:function(){return new r(l.Yb(c.k),l.Yb(s.a),l.Yb(v.a),l.Yb(m.a),l.Yb(d.a),l.Yb(h.b),l.Yb(o.a),l.Yb(S.a),l.Yb(g.a),l.Yb(p.a))},token:r,providedIn:"root"}),r),_=((a=function(){function t(t,e,n,i,a,r){this.translate=t,this.configService=e,this.motionPdfService=n,this.pdfService=i,this.motionRepo=a,this.categoryRepo=r,this.categoryObserver=this.categoryRepo.getViewModelListBehaviorSubject()}var e=t.prototype;return e.motionListToDocDef=function(t,e){for(var n=[],i=[],a=0;a<t.length;++a)try{var r=this.motionPdfService.motionToDocDef(t[a],e);r[0].id=""+t[a].id,i.push(r),a<t.length-1&&i.push(this.pdfService.getPageBreak())}catch(s){var o=this.translate.instant("Error during PDF creation of motion:")+" "+t[a].identifierOrTitle;throw console.error(o+"\nDebugInfo:\n",s),new h.c(o)}return t.length>1&&(!e.pdfOptions||e.pdfOptions.includes("toc"))&&n.push(this.pdfService.createTitle("motions_export_title"),this.pdfService.createPreamble("motions_export_preamble"),this.createToc(t)),n.concat(i)},e.createToc=function(t,e){var n=this,i=[],a=this.categoryObserver.value,r={text:this.translate.instant("Table of contents"),style:"heading2"},o=this.configService.instant("motions_export_submitter_recommendation"),s=o?this.getTocHeaderDefinition():void 0,l=o?h.a.LIGHT_HORIZONTAL_LINES:h.a.DEFAULT;if(a&&a.length){var c=[],u=function(){if(f){if(m>=d.length)return"break";p=d[m++]}else{if((m=d.next()).done)return"break";p=m.value}var e=p,i=t.filter(function(t){return e===t.category});if(i&&i.length){c.length&&c.push(n.pdfService.getPageBreak()),c.push({table:{body:[[{text:e.nameWithParentAbove,style:e.parent?"tocSubcategoryTitle":"tocCategoryTitle"}]]},layout:o?"lightHorizontalLines":"noBorders"});var a=[],r=i,u=Array.isArray(r),v=0;for(r=u?r:r[Symbol.iterator]();;){var g;if(u){if(v>=r.length)break;g=r[v++]}else{if((v=r.next()).done)break;g=v.value}var b=g;a.push(o?n.appendSubmittersAndRecommendation(b,h.d.CATEGORY_SECTION):n.pdfService.createTocLine(""+(b.identifier?b.identifier:""),b.title,""+b.id,h.d.CATEGORY_SECTION))}c.push(n.pdfService.createTocTableDef(a,h.d.CATEGORY_SECTION,l,s?JSON.parse(JSON.stringify(s)):null))}},d=a.sort(function(t,e){return t.weight-e.weight}),f=Array.isArray(d),m=0;for(d=f?d:d[Symbol.iterator]();;){var p;if("break"===u())break}var v=t.filter(function(t){return!t.category}).map(function(t){return n.pdfService.createTocLine(""+(t.identifier?t.identifier:""),t.title,""+t.id)});v.length>0&&(c.push(this.pdfService.getPageBreak()),c.push(this.pdfService.createTocTableDef(v,h.d.CATEGORY_SECTION))),i.push(c)}else{var g=[],b=t,T=Array.isArray(b),S=0;for(b=T?b:b[Symbol.iterator]();;){var x;if(T){if(S>=b.length)break;x=b[S++]}else{if((S=b.next()).done)break;x=S.value}var y=x;g.push(o?this.appendSubmittersAndRecommendation(y):this.pdfService.createTocLine(""+(y.identifier?y.identifier:""),y.title,""+y.id))}i.push(this.pdfService.createTocTableDef(g,h.d.CATEGORY_SECTION,l,s))}return[r,i,this.pdfService.getPageBreak()]},e.getTocHeaderDefinition=function(){return[{text:this.translate.instant("Identifier"),style:"tocHeaderRow"},{style:"tocHeaderRow",text:[this.translate.instant("Title")+" \xb7 "+this.translate.instant("Submitters")+" \xb7 ",{text:""+this.translate.instant("Recommendation"),italics:!0}]},{text:this.translate.instant("Page"),style:"tocHeaderRow",alignment:"right"}]},e.appendSubmittersAndRecommendation=function(t,e){void 0===e&&(e=h.d.DEFAULT);for(var n=this.motionRepo.getExtendedRecommendationLabel(t),i="",a=0;a<t.submitters.length;++a)i+=a!==t.submitters.length-1?t.submitters[a].getTitle()+", ":t.submitters[a].getTitle();return this.pdfService.createTocLine(""+(t.identifier?t.identifier:""),t.title,""+t.id,e,this.pdfService.createTocLineInline(i),this.pdfService.createTocLineInline(n,!0))},t}()).ngInjectableDef=l.Xb({factory:function(){return new a(l.Yb(c.k),l.Yb(d.a),l.Yb(y),l.Yb(h.b),l.Yb(s.a),l.Yb(f.a))},token:a,providedIn:"root"}),a);n.d(e,"a",function(){return R});var L,R=((L=function(){function t(t,e,n,i,a,r){this.translate=t,this.configService=e,this.motionPdfService=n,this.amendmentListPdfService=i,this.pdfCatalogService=a,this.pdfDocumentService=r}var e=t.prototype;return e.exportSingleMotion=function(t,e){var n=this.motionPdfService.motionToDocDef(t,e),i=this.translate.instant("Motion")+" "+t.identifierOrTitle;this.pdfDocumentService.download(n,i,{title:i})},e.exportMotionCatalog=function(t,e){var n=this.pdfCatalogService.motionListToDocDef(t,e),i=this.configService.instant("motions_export_title"),a=this.translate.instant(i);this.pdfDocumentService.download(n,a,{title:a},e)},e.exportPdfCallList=function(t){var e=this.motionPdfService.callListToDoc(t),n=this.translate.instant("Call list");this.pdfDocumentService.downloadLandscape(e,n,{title:n})},e.exportPersonalNote=function(t,e){var n=this.motionPdfService.textToDocDef(t.note,e,"Personal note"),i=e.identifierOrTitle+" - "+this.translate.instant("Personal note");this.pdfDocumentService.download(n,i,{title:i})},e.exportComment=function(t,e){var n=e.getCommentForSection(t);if(n&&n.comment){var i=this.motionPdfService.textToDocDef(n.comment,e,t.name),a=e.identifierOrTitle+" - "+t.name;this.pdfDocumentService.download(i,a,{title:a})}},e.exportAmendmentList=function(t,e){var n;n=e?this.translate.instant("Amendments to")+" "+e.getListTitle():""+this.translate.instant("Amendments");var i=this.amendmentListPdfService.overviewToDocDef(n,t);this.pdfDocumentService.downloadLandscape(i,n,{title:n})},t}()).ngInjectableDef=l.Xb({factory:function(){return new L(l.Yb(c.k),l.Yb(d.a),l.Yb(y),l.Yb(u),l.Yb(_),l.Yb(h.b))},token:L,providedIn:"root"}),L)},ykax:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n("+KbT"),a=n("n+VD"),r=n("8Y7J"),o=function(){var t=function(t){function e(e){var n;return(n=t.call(this)||this).pollValues=["yes","no","abstain","votesvalid","votesinvalid","votescast"],e.get("motions_poll_100_percent_base").subscribe(function(t){return n.percentBase=t}),e.get("motions_poll_default_majority_method").subscribe(function(t){return n.defaultMajorityMethod=t}),n}_inheritsLoose(e,t);var n=e.prototype;return n.calculatePercentage=function(t,e){var n=this.getBaseAmount(t);if(!n)return null;switch(e){case"abstain":if("YES_NO"===this.percentBase)return null;break;case"votesinvalid":if("CAST"!==this.percentBase)return null;break;case"votesvalid":if(!["CAST","VALID"].includes(this.percentBase))return null;break;case"votescast":if("CAST"!==this.percentBase)return null}return Math.round(100*t[e]/n*100)/100},n.getBaseAmount=function(t){if(!t)return 0;switch(this.percentBase){case"CAST":return t.votescast?t.votesinvalid<0?0:t.votescast:0;case"VALID":return t.yes<0||t.no<0||t.abstain<0?0:t.votesvalid?t.votesvalid:0;case"YES_NO_ABSTAIN":return t.yes<0||t.no<0||t.abstain<0?0:t.yes+t.no+t.abstain;case"YES_NO":return t.yes<0||t.no<0||-1===t.abstain?0:t.yes+t.no}},n.calculateQuorum=function(t,e){e||(e=this.defaultMajorityMethod);var n=this.getBaseAmount(t);if(n){var i=a.a.find(function(t){return t.value===e});return i&&i.calc?i.calc(n):null}},n.isAbstractValue=function(t,e){if(0===this.getBaseAmount(t))return!0;switch(this.percentBase){case"YES_NO":if(["votescast","votesinvalid","votesvalid","abstain"].includes(e))return!0;break;case"YES_NO_ABSTAIN":if(["votescast","votesinvalid","votesvalid"].includes(e))return!0;break;case"VALID":if(["votesinvalid","votescast"].includes(e))return!0}return t[e]<0},e}(a.b);return t.ngInjectableDef=r.Xb({factory:function(){return new t(r.Yb(i.a))},token:t,providedIn:"root"}),t}()}}]);