======================
概要
======================

hive-builder は複数台のサーバにまたがって docker コンテナを運用するサイトを構築するためのツールです。Kubernetes を使用せず docker swarm mode によるクラスタ機能と drbd9 によるディスク冗長化機能を使用することで、シンプルな構成でサイトを構築できます。

- コントローラを必要とせず、 hive を構成するサーバが選挙によってリーダを選出する方式により split brain を防ぎます
- docker swarm クラスタを構築することで、高い可用性を確保できます
- drbd でディスクをミラーリングすることで、データボリュームを持つコンテナもマイグレーションできます
- コマンドを1回起動するだけでAWSなどの IaaS 上にサイトを構築できます
- ansible の role でコンテナの構築内容を記述できます
- サイト内にプライベートなリポジトリサーバを持ち、コンテナイメージを保存します
- サイト内にZabbix サーバを持ち、稼働を監視します
- 1個のインベントリから3段階のステージングに分けて環境を構築できます

サイトの構築は、以下の7つのフェーズを順に実行することで行われます。

=================== =================== ==============================
フェーズ名          対象                内容
=================== =================== ==============================
build-infra         ホスト,ネットワーク ホストとネットワークを作成し、
                                        環境を構築する
setup-hosts         ホスト              ホストを設定する
build-images        コンテナイメージ    コンテナイメージをビルドする
build-networks      内部ネットワーク    内部ネットワークを構築する
build-volumes       ボリューム          ボリュームを構築する
deploy-serivces     サービス            サービスを配備する
initialize-serivces サービス            サービスを初期化する
=================== =================== ==============================

ステージングには以下の3つがあります。

=========== ===================
ステージ名  説明
=========== ===================
private     開発者個人のテスト環境です
staging     結合テストを実施する検証用の環境です
production  本番環境です
=========== ===================
